# DLS Face Recognition project

Данный репозиторий представляет собой структуру проекта по задаче распознавания лиц

## Структура проекта 

AllStaff.py - все необходимые функции для полного выполнения пайплайна распознавания лиц
       
models.py - код моделей для импорта и использования в пайплайне
       
Task2.ipynb - Задание 2, обучение моделей классификации
        
Task3.ipynb - задание 3, примеры использования пайплайна

+--datasets: - папка с csv файлами сохраненных датасетов      
+---'. . .\_aligned' - датасеты, содержащие оригинальные названия картинок, id личности, изображенной на ней и пути к выровненным изображениям, который использовался мной для обучения      
+---'processed\_. . .' - датасеты содержащие оригинальное название, личность, параметры bbox, относительные координаты ключевых точек и пути к оригинальным изображениям      

+--task 1 - задание 1, отбор фотографий + stacked hourglass network  :   
+----dataset_prepare - отбор фотографий       
+----FRProject - блокнот с обучением stacked hourglass и афинным преобразованием фотографий    

## Использование
Веса моделей можно установить по ссылке - https://drive.google.com/drive/folders/1BJrTebLlIZjTROwX2EyM8EFcWOGJf8YF?usp=sharing       

В пайплайне используются 'weights\final_ce_model.pth' и 'weights\final_arc_model' в зависимости от выбранного флага use_arcface, 'weights\yolov8n-face' для модели детекции и 'weights\hourglass_model' для модели поиска точек

```python
# Импортируем всё необходимое для работы пайплайна
from AllStaff import *
# Устанавливаем режим модели распознавания (ArcFace/CE)
load_embedding_model(use_arcface=False)
# Запускаем функцию мэтчинга
matches = match_and_show_pairs(
    r"path_to_image_1.jpg",
    r"path_to_image_2.jpg",
    threshold=0.3 '''Ну тут по желанию, обе мои модели довольно плохи в сравнении
    лиц, однако при планке в районе 0.46 пользоваться CE моделью кое-как возможно'''
)
```
## Для связи
tg - @Dance_of_the_God
